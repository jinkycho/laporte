<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="UserMapper">

    <!-- Beans 클래스의 객체이름(id)과 클래스이름(type)을 명시한다. -->
    <resultMap id="userMap"
        type="com.project.laporte.model.User">
        <!-- Beans의 멤버변수(property)이름과 대상 테이블의 컬럼(column)을 연결한다. -->
        <result property="userno" column="userno" />
        <result property="userid" column="userid" />
        <result property="userpwd" column="userpwd" />
        <result property="name" column="name" />
        <result property="birthdate" column="birthdate" />
        <result property="phoneno" column="phoneno" />
        <result property="gender" column="gender" />
        <result property="addr1" column="addr1" />
        <result property="addr2" column="addr2" />
        <result property="postcode" column="postcode" />
        <result property="userstatus" column="userstatus" />
        <result property="regdate" column="regdate" />
        <result property="editdate" column="editdate" />
        <result property="point" column="point" />
    </resultMap>
	
	<!-- 회원정보 저장을 위한 기능 정의 -->
	<insert id="insertUser"
		parameterType = "com.project.laporte.model.User"
		useGeneratedKeys="true" keyProperty="userno">
		INSERT INTO user(userid, userpwd, name, birthdate, phoneno, gender, addr1, addr2,
		postcode, userstatus, regdate, editdate, point)
		VALUES(#{userid}, #{userpwd}, #{name}, #{birthdate}, #{phoneno}, #{gender},
		#{addr1}, #{addr2}, #{postcode}, 'Y', now(), now(), 0
		)
	</insert>
	
	
	<!--  회원정보 조회를  위한 기능 정의 -->
	<select id="idDblCheck" parameterType = "com.project.laporte.model.User" resultMap="userMap">
		SELECT userid FROM user WHERE userid like #{userid}
	</select>
	
	<!--  아이디 중복 확인을 위한 기능 정의 -->
	<select id="selectItem" parameterType = "com.project.laporte.model.User" resultMap="userMap">
		SELECT userid, userpwd, name, DATE_FORMAT(birthdate, %Y-%m-%d') AS birthdate, phoneno, gender, addr1, addr2,
		postcode, editdate, point FROM user WHERE userno = #{userno}
	</select>
</mapper>